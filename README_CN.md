# åŸºäº LLM/VLM/æ–‡ç”Ÿå›¾çš„å¹¿å‘Šåˆ›æ„å…¨é“¾è·¯ç”Ÿæˆä¸å®éªŒå¹³å°

**Language / è¯­è¨€**: [English](README.md) | ç®€ä½“ä¸­æ–‡

åŸºäºé˜¿é‡Œäº‘é€šä¹‰ä¸‡ç›¸å’Œé€šä¹‰åƒé—®çš„æ™ºèƒ½å¹¿å‘Šåˆ›æ„ç”Ÿæˆå¹³å°ï¼Œæä¾›ä»æ–‡æ¡ˆç”Ÿæˆåˆ°å›¾åƒåˆ›ä½œçš„å®Œæ•´å·¥ä½œæµï¼Œæ”¯æŒ A/B å®éªŒã€æ¨¡å‹è¿½è¸ªå’Œæ’ä»¶åŒ–éƒ¨ç½²ã€‚

[![Go Version](https://img.shields.io/badge/Go-1.20+-blue.svg)](https://go.dev/)
[![React Version](https://img.shields.io/badge/React-18.3+-61dafb.svg)](https://reactjs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.7+-3178c6.svg)](https://www.typescriptlang.org/)
[![PostgreSQL](https://img.shields.io/badge/PostgreSQL-14+-336791.svg)](https://www.postgresql.org/)

![](https://raw.githubusercontent.com/NEDONION/my-pics-space/main/20251216012927.png)

![](https://raw.githubusercontent.com/NEDONION/my-pics-space/main/20251216013013.png)

![](https://raw.githubusercontent.com/NEDONION/my-pics-space/main/20251216013040.png)

![](https://raw.githubusercontent.com/NEDONION/my-pics-space/main/20251216013103.png)

![](https://raw.githubusercontent.com/NEDONION/my-pics-space/main/20251216013125.png)

![](https://raw.githubusercontent.com/NEDONION/my-pics-space/main/20251216013218.png)

![](https://raw.githubusercontent.com/NEDONION/my-pics-space/main/20251216013344.png)

![](https://raw.githubusercontent.com/NEDONION/my-pics-space/main/20251216013421.png)

## ç›®å½•

- [æ ¸å¿ƒåŠŸèƒ½](#æ ¸å¿ƒåŠŸèƒ½)
- [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
- [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [ç¯å¢ƒé…ç½®](#ç¯å¢ƒé…ç½®)
- [éƒ¨ç½²æŒ‡å—](#éƒ¨ç½²æŒ‡å—)
- [API æ¥å£](#api-æ¥å£)
- [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)

## æ ¸å¿ƒåŠŸèƒ½

### 1. æ™ºèƒ½åˆ›æ„ç”Ÿæˆå·¥ä½œæµ

å®Œæ•´çš„åˆ›æ„ç”Ÿæˆé“¾è·¯ï¼Œä»æ–‡æ¡ˆåˆ°å›¾åƒä¸€ç«™å¼å®Œæˆï¼š

- **AI æ–‡æ¡ˆç”Ÿæˆ** - åŸºäºé€šä¹‰åƒé—®è‡ªåŠ¨ç”Ÿæˆ CTA å’Œå¤šä¸ªå–ç‚¹å€™é€‰
- **æ–‡æ¡ˆç¡®è®¤æœºåˆ¶** - ç”¨æˆ·é€‰æ‹©æˆ–è‡ªå®šä¹‰æ–‡æ¡ˆåå†å¯åŠ¨å›¾åƒç”Ÿæˆ
- **AI å›¾åƒç”Ÿæˆ** - é›†æˆé€šä¹‰ä¸‡ç›¸ç”Ÿæˆä¸“ä¸šå¹¿å‘Šåˆ›æ„å›¾
- **å¤šå°ºå¯¸æ”¯æŒ** - æ”¯æŒ 1:1ã€9:16ã€16:9 ç­‰å¤šç§å¹¿å‘Šå°ºå¯¸
- **å˜ä½“ç”Ÿæˆ** - ä¸€æ¬¡ç”Ÿæˆå¤šä¸ªåˆ›æ„å˜ä½“ä¾›é€‰æ‹©å’Œå¯¹æ¯”
- **è‡ªå®šä¹‰æç¤ºè¯** - æ”¯æŒä¸ºæ¯ä¸ªå˜ä½“å®šåˆ¶ä¸åŒçš„ç”Ÿæˆæç¤ºè¯å’Œé£æ ¼

### 2. A/B å®éªŒå¹³å°

å¼ºå¤§çš„å®éªŒç®¡ç†å’Œæ•ˆæœè¯„ä¼°ç³»ç»Ÿï¼š

- **å®éªŒåˆ›å»º** - ä»ç´ æåº“é€‰æ‹©åˆ›æ„åˆ›å»ºå¯¹æ¯”å®éªŒ
- **æ™ºèƒ½åˆ†æµ** - åŸºäºç”¨æˆ· ID å“ˆå¸Œçš„åˆ†æ¡¶æœºåˆ¶ (0-10000)
- **æƒé‡é…ç½®** - çµæ´»è®¾ç½®å˜ä½“æµé‡åˆ†é…æƒé‡
- **å®æ—¶æŒ‡æ ‡** - æ›å…‰é‡ã€ç‚¹å‡»é‡ã€CTR å®æ—¶ç»Ÿè®¡
- **åœ¨çº¿ä½¿ç”¨** - é€šè¿‡ API åˆ†é…å˜ä½“å’Œè®°å½•æŒ‡æ ‡
- **æœ¬åœ°é¢„è§ˆ** - æ”¯æŒåµŒå…¥å¼æ’ä»¶é¢„è§ˆå®éªŒæ•ˆæœ

### 3. ä»»åŠ¡ç®¡ç†ç³»ç»Ÿ

å®Œæ•´çš„ä»»åŠ¡ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼š

- **ä»»åŠ¡çŠ¶æ€è¿½è¸ª** - pending â†’ queued â†’ processing â†’ completed/failed
- **è¿›åº¦å¯è§†åŒ–** - å®æ—¶æ˜¾ç¤ºä»»åŠ¡å¤„ç†è¿›åº¦ (0-100%)
- **æ‰¹é‡ç”Ÿæˆ** - æ”¯æŒåŒæ—¶ç”Ÿæˆå¤šä¸ªå°ºå¯¸å’Œå˜ä½“
- **ä»»åŠ¡åˆ é™¤** - æ”¯æŒåˆ é™¤ä»»åŠ¡åŠå…³è”ç´ æ
- **é¦–å›¾é¢„è§ˆ** - ä»»åŠ¡åˆ—è¡¨å¿«é€Ÿé¢„è§ˆé¦–ä¸ªç”Ÿæˆçš„ç´ æ

### 4. ç´ æç®¡ç†

é›†ä¸­åŒ–çš„åˆ›æ„ç´ æåº“ï¼š

- **åˆ†é¡µæµè§ˆ** - é«˜æ•ˆçš„åˆ†é¡µåŠ è½½æœºåˆ¶
- **æ ¼å¼ç­›é€‰** - æŒ‰å°ºå¯¸ (1:1, 9:16, 16:9) ç­›é€‰ç´ æ
- **è´¨é‡è¯„åˆ†** - CTR é¢„æµ‹ã€NSFW æ£€æµ‹ã€ç»¼åˆè´¨é‡è¯„åˆ†
- **äº‘ç«¯å­˜å‚¨** - è‡ªåŠ¨ä¸Šä¼ ä¸ƒç‰›äº‘ CDN
- **å…ƒæ•°æ®ç®¡ç†** - è®°å½•æ–‡æ¡ˆã€å–ç‚¹ã€ç”Ÿæˆå‚æ•°ç­‰å®Œæ•´ä¿¡æ¯

### 5. æ¨¡å‹è°ƒç”¨è¿½è¸ª

AI æ¨¡å‹è°ƒç”¨çš„å®Œæ•´é“¾è·¯è¿½è¸ªï¼š

- **è°ƒç”¨é“¾è®°å½•** - è®°å½•æ¯æ¬¡ AI æ¨¡å‹è°ƒç”¨çš„å®Œæ•´ä¿¡æ¯
- **æ­¥éª¤æ‹†åˆ†** - ç»†åŒ–åˆ°æ–‡æ¡ˆç”Ÿæˆã€å›¾åƒç”Ÿæˆç­‰å„ä¸ªæ­¥éª¤
- **æ€§èƒ½ç›‘æ§** - è¿½è¸ªæ¯ä¸ªæ­¥éª¤çš„è€—æ—¶ (ms)
- **çŠ¶æ€è¿½è¸ª** - success/failed/running çŠ¶æ€æ ‡è®°
- **è¾“å…¥è¾“å‡ºé¢„è§ˆ** - è®°å½•è¯·æ±‚å‚æ•°å’Œå“åº”ç»“æœé¢„è§ˆ
- **é”™è¯¯è¯Šæ–­** - å¤±è´¥æ—¶è®°å½•è¯¦ç»†é”™è¯¯ä¿¡æ¯

### 6. æ’ä»¶åŒ–éƒ¨ç½²

æ”¯æŒåµŒå…¥ç¬¬ä¸‰æ–¹åº”ç”¨çš„æ’ä»¶ç³»ç»Ÿï¼š

- **ç‹¬ç«‹ç»„ä»¶** - `experiment-widget.js` å¯åµŒå…¥ä»»æ„ç½‘é¡µ
- **æœ¬åœ°é¢„è§ˆ** - æ’ä»¶é¢„è§ˆé¡µé¢æ¨¡æ‹ŸçœŸå®ä½¿ç”¨åœºæ™¯
- **åŠ¨æ€åŠ è½½** - æ— éœ€é‡æ–°éƒ¨ç½²å³å¯æ›´æ–°å®éªŒé…ç½®
- **å›½é™…åŒ–æ”¯æŒ** - ä¸­è‹±æ–‡åŒè¯­ç•Œé¢åˆ‡æ¢

## æŠ€æœ¯æ¶æ„

### æŠ€æœ¯æ ˆå…¨æ™¯å›¾

é¡¹ç›®é‡‡ç”¨ç°ä»£åŒ–å…¨æ ˆæŠ€æœ¯æ¶æ„ï¼Œå‰ç«¯ React + TypeScriptï¼Œåç«¯ Go + Ginï¼Œé›†æˆé˜¿é‡Œäº‘ AI æœåŠ¡ã€‚

```mermaid
graph TB
    subgraph Frontend["å‰ç«¯æŠ€æœ¯æ ˆ"]
        React["React 18.3<br/>UI æ¡†æ¶"]
        TS["TypeScript 5.7<br/>ç±»å‹ç³»ç»Ÿ"]
        Vite["Vite 6.0<br/>æ„å»ºå·¥å…·"]
        Router["React Router 6.28<br/>è·¯ç”±ç®¡ç†"]
        Axios["Axios 1.7<br/>HTTP å®¢æˆ·ç«¯"]
        I18n["i18n<br/>å›½é™…åŒ–"]
    end

    subgraph Backend["åç«¯æŠ€æœ¯æ ˆ"]
        Go["Go 1.20+<br/>ç¼–ç¨‹è¯­è¨€"]
        Gin["Gin 1.9<br/>Web æ¡†æ¶"]
        GORM["GORM 1.31<br/>ORM æ¡†æ¶"]
        UUID["UUID v6<br/>å”¯ä¸€æ ‡è¯†"]
        Env["godotenv<br/>ç¯å¢ƒé…ç½®"]
    end

    subgraph Database["æ•°æ®åº“"]
        PG["PostgreSQL 14+<br/>(æ¨è)"]
        MySQL["MySQL 8.0+<br/>(å¯é€‰)"]
    end

    subgraph AIServices["AI æœåŠ¡"]
        Qwen["é€šä¹‰åƒé—®<br/>qwen-turbo<br/>æ–‡æ¡ˆç”Ÿæˆ"]
        Tongyi["é€šä¹‰ä¸‡ç›¸<br/>wanx-v1<br/>å›¾åƒç”Ÿæˆ"]
    end

    subgraph CloudServices["äº‘æœåŠ¡"]
        Qiniu["ä¸ƒç‰›äº‘<br/>å¯¹è±¡å­˜å‚¨ + CDN"]
        AliCloud["é˜¿é‡Œäº‘<br/>DashScope API"]
    end

    subgraph DevOps["éƒ¨ç½² & è¿ç»´"]
        Docker["Docker<br/>å®¹å™¨åŒ–"]
        Railway["Railway<br/>äº‘å¹³å°"]
        Nginx["Nginx<br/>åå‘ä»£ç†"]
    end

    Frontend --> Backend
    Backend --> Database
    Backend --> AIServices
    Backend --> CloudServices
    AIServices --> AliCloud
    CloudServices --> Qiniu

    style Frontend fill:#61dafb,stroke:#333,color:#000
    style Backend fill:#00ADD8,stroke:#333,color:#fff
    style Database fill:#336791,stroke:#333,color:#fff
    style AIServices fill:#ff6b35,stroke:#333,color:#fff
    style CloudServices fill:#00a67d,stroke:#333,color:#fff
    style DevOps fill:#2496ed,stroke:#333,color:#fff
```

### åç«¯æŠ€æœ¯æ ˆ

```
Go 1.20+
â”œâ”€â”€ Web æ¡†æ¶: Gin 1.9
â”œâ”€â”€ ORM: GORM 1.31
â”œâ”€â”€ æ•°æ®åº“é©±åŠ¨:
â”‚   â”œâ”€â”€ gorm.io/driver/postgres (PostgreSQL)
â”‚   â””â”€â”€ gorm.io/driver/mysql (MySQL)
â”œâ”€â”€ UUID: github.com/google/uuid
â””â”€â”€ ç¯å¢ƒé…ç½®: github.com/joho/godotenv
```

**æ ¸å¿ƒä¾èµ–:**
- **Gin** - é«˜æ€§èƒ½ HTTP Web æ¡†æ¶
- **GORM** - å¼ºå¤§çš„ ORM åº“,æ”¯æŒå¤šæ•°æ®åº“
- **UUID v6** - ç”Ÿæˆå”¯ä¸€æ ‡è¯†ç¬¦

### å‰ç«¯æŠ€æœ¯æ ˆ

```
React 18.3 + TypeScript 5.7 + Vite 6.0
â”œâ”€â”€ UI æ¡†æ¶: React 18.3.1
â”œâ”€â”€ ç±»å‹ç³»ç»Ÿ: TypeScript 5.7.2
â”œâ”€â”€ æ„å»ºå·¥å…·: Vite 6.0.5
â”œâ”€â”€ è·¯ç”±ç®¡ç†: React Router 6.28.0
â”œâ”€â”€ HTTP å®¢æˆ·ç«¯: Axios 1.7.9
â””â”€â”€ å›½é™…åŒ–: è‡ªç ” i18n æ–¹æ¡ˆ
```

**é¡µé¢è·¯ç”±:**
- `/` - Dashboard æ¦‚è§ˆ
- `/creative` - åˆ›æ„ç”Ÿæˆå™¨
- `/tasks` - ä»»åŠ¡åˆ—è¡¨
- `/assets` - ç´ æåº“
- `/experiments` - å®éªŒç®¡ç†
- `/experiments/new` - åˆ›å»ºå®éªŒ
- `/traces` - æ¨¡å‹è¿½è¸ª
- `/plugin-preview` - æ’ä»¶é¢„è§ˆ

### ç¬¬ä¸‰æ–¹æœåŠ¡

**AI æœåŠ¡:**
- **é˜¿é‡Œäº‘é€šä¹‰ä¸‡ç›¸ (wanx-v1)** - æ–‡ç”Ÿå›¾æ¨¡å‹
- **é˜¿é‡Œäº‘é€šä¹‰åƒé—® (qwen-turbo)** - å¤§è¯­è¨€æ¨¡å‹

**äº‘æœåŠ¡:**
- **ä¸ƒç‰›äº‘å¯¹è±¡å­˜å‚¨** - CDN åŠ é€Ÿçš„ç´ æå­˜å‚¨
- **PostgreSQL/MySQL** - å…³ç³»å‹æ•°æ®åº“

## ç³»ç»Ÿæ¶æ„

### ä¸šåŠ¡æ¶æ„å›¾

ç³»ç»Ÿé‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ï¼Œä»ä¸Šåˆ°ä¸‹ä¾æ¬¡ä¸ºï¼šç”¨æˆ·ç•Œé¢å±‚ã€API ç½‘å…³å±‚ã€æœåŠ¡å±‚ã€å¤–éƒ¨æœåŠ¡é›†æˆå±‚ã€æ•°æ®æŒä¹…å±‚ã€‚

```mermaid
graph TB
    subgraph UI["ç”¨æˆ·ç•Œé¢å±‚ (React)"]
        Dashboard[Dashboard æ¦‚è§ˆ]
        Creative[åˆ›æ„ç”Ÿæˆå™¨]
        Tasks[ä»»åŠ¡ç®¡ç†]
        Assets[ç´ æåº“]
        Experiments[å®éªŒå¹³å°]
        Traces[æ¨¡å‹è¿½è¸ª]
    end

    subgraph API["API ç½‘å…³å±‚ (Gin)"]
        CopyAPI["/api/v1/copywriting/*"]
        CreativeAPI["/api/v1/creative/*"]
        ExpAPI["/api/v1/experiments/*"]
        TraceAPI["/api/v1/model_traces/*"]
    end

    subgraph Services["æœåŠ¡å±‚"]
        CopyService["CopywritingService<br/>æ–‡æ¡ˆç”Ÿæˆ & å€™é€‰"]
        CreativeService["CreativeService<br/>å›¾åƒç”Ÿæˆ & ä»»åŠ¡ç®¡ç†"]
        ExpService["ExperimentService<br/>å®éªŒç®¡ç† & åˆ†æµç®—æ³•"]
        TraceService["TraceService<br/>è°ƒç”¨é“¾è¿½è¸ª"]
    end

    subgraph External["å¤–éƒ¨æœåŠ¡é›†æˆå±‚"]
        Qwen["QwenClient<br/>(é€šä¹‰åƒé—®)"]
        Tongyi["TongyiClient<br/>(é€šä¹‰ä¸‡ç›¸)"]
        Qiniu["QiniuService<br/>(ä¸ƒç‰›äº‘)"]
    end

    subgraph DB["æ•°æ®æŒä¹…å±‚ (GORM)"]
        TaskTable[(CreativeTasks)]
        AssetTable[(CreativeAssets)]
        ExpTable[(Experiments)]
        TraceTable[(ModelTraces)]
    end

    UI --> API
    API --> Services
    Services --> External
    Services --> DB
    External -.ä¸Šä¼ ç´ æ.-> Qiniu

    style UI fill:#e1f5ff
    style API fill:#fff3e0
    style Services fill:#f3e5f5
    style External fill:#e8f5e9
    style DB fill:#fce4ec
```

### æ ¸å¿ƒå·¥ä½œæµ

#### 1. åˆ›æ„ç”Ÿæˆæµç¨‹å›¾

ä»æ–‡æ¡ˆç”Ÿæˆåˆ°å›¾åƒç”Ÿæˆçš„å®Œæ•´å·¥ä½œæµï¼ŒåŒ…å«ç”¨æˆ·ç¡®è®¤ç¯èŠ‚å’Œå¤šå˜ä½“å¹¶å‘ç”Ÿæˆæœºåˆ¶ã€‚

```mermaid
flowchart TD
    Start([ç”¨æˆ·è¾“å…¥äº§å“å]) --> GenCopy[è°ƒç”¨é€šä¹‰åƒé—®ç”Ÿæˆæ–‡æ¡ˆå€™é€‰]
    GenCopy --> Candidates[ç”Ÿæˆ CTA Ã— 3<br/>å–ç‚¹ Ã— 6]
    Candidates --> UserSelect{ç”¨æˆ·é€‰æ‹©/ç¼–è¾‘æ–‡æ¡ˆ}
    UserSelect --> Confirm[æäº¤ç¡®è®¤]
    Confirm --> CreateTask[åˆ›å»º CreativeTask<br/>status=pending]
    CreateTask --> Loop{éå†å°ºå¯¸ Ã— å˜ä½“}

    Loop -->|æ¯ä¸ªç»„åˆ| GenPrompt[ç”Ÿæˆæç¤ºè¯]
    GenPrompt --> CallTongyi[è°ƒç”¨é€šä¹‰ä¸‡ç›¸ç”Ÿæˆå›¾ç‰‡]
    CallTongyi --> Upload[ä¸Šä¼ ä¸ƒç‰›äº‘ CDN]
    Upload --> CreateAsset[åˆ›å»º CreativeAsset]
    CreateAsset --> Loop

    Loop -->|å…¨éƒ¨å®Œæˆ| UpdateStatus[æ›´æ–°ä»»åŠ¡çŠ¶æ€<br/>status=completed]
    UpdateStatus --> End([å®Œæˆ])

    style Start fill:#e1f5ff
    style GenCopy fill:#fff3e0
    style UserSelect fill:#f3e5f5
    style Loop fill:#ffe0b2
    style End fill:#c8e6c9
```

#### 2. A/B å®éªŒæµç¨‹å›¾

åŸºäºå“ˆå¸Œåˆ†æ¡¶çš„æµé‡åˆ†é…æœºåˆ¶ï¼Œæ”¯æŒå®æ—¶æŒ‡æ ‡ç»Ÿè®¡å’Œ CTR è®¡ç®—ã€‚

```mermaid
flowchart TD
    Start([åˆ›å»ºå®éªŒ]) --> Select[é€‰æ‹©å¤šä¸ªç´ æä½œä¸ºå˜ä½“]
    Select --> SetWeight[è®¾ç½®æƒé‡<br/>å¦‚: 0.5, 0.5]
    SetWeight --> CalcBucket[è®¡ç®—åˆ†æ¡¶åŒºé—´<br/>0-5000, 5000-10000]
    CalcBucket --> Active[å¯åŠ¨å®éªŒ<br/>status=active]

    Active --> UserVisit([ç”¨æˆ·è®¿é—®])
    UserVisit --> Assign[è°ƒç”¨ /assign API]
    Assign --> Hash[hash user_id % 10000<br/>å¾—åˆ°åˆ†æ¡¶å€¼]
    Hash --> Match[åŒ¹é…åˆ†æ¡¶åŒºé—´]
    Match --> Return[è¿”å›åˆ†é…çš„å˜ä½“]

    Return --> Display[å±•ç¤ºå¹¿å‘Š]
    Display --> RecordHit[è®°å½•æ›å…‰<br/>POST /hit]

    RecordHit --> UserClick{ç”¨æˆ·æ˜¯å¦ç‚¹å‡»?}
    UserClick -->|æ˜¯| RecordClick[è®°å½•ç‚¹å‡»<br/>POST /click]
    UserClick -->|å¦| End1([ç»“æŸ])
    RecordClick --> CalcCTR[å®æ—¶è®¡ç®— CTR<br/>clicks / impressions]
    CalcCTR --> End2([ç»“æŸ])

    style Start fill:#e1f5ff
    style Active fill:#c8e6c9
    style Hash fill:#fff3e0
    style Display fill:#f3e5f5
    style CalcCTR fill:#ffe0b2
```

### æ•°æ®åº“è®¾è®¡

**æ ¸å¿ƒæ•°æ®è¡¨:**

```sql
-- åˆ›æ„ä»»åŠ¡è¡¨
creative_tasks
â”œâ”€â”€ id (UUID ä¸»é”®)
â”œâ”€â”€ user_id (ç”¨æˆ· ID)
â”œâ”€â”€ product_name (äº§å“åç§°)
â”œâ”€â”€ cta_text (CTA æ–‡æ¡ˆ)
â”œâ”€â”€ selling_points (å–ç‚¹æ•°ç»„ JSON)
â”œâ”€â”€ cta_candidates (CTA å€™é€‰ JSON)
â”œâ”€â”€ selling_point_candidates (å–ç‚¹å€™é€‰ JSON)
â”œâ”€â”€ requested_formats (è¯·æ±‚å°ºå¯¸ JSON)
â”œâ”€â”€ num_variants (å˜ä½“æ•°é‡)
â”œâ”€â”€ variant_prompts (å˜ä½“æç¤ºè¯ JSON)
â”œâ”€â”€ variant_styles (å˜ä½“é£æ ¼ JSON)
â”œâ”€â”€ status (ä»»åŠ¡çŠ¶æ€)
â”œâ”€â”€ progress (è¿›åº¦ 0-100)
â”œâ”€â”€ first_asset_url (é¦–å›¾é¢„è§ˆ)
â””â”€â”€ timestamps (æ—¶é—´æˆ³)

-- åˆ›æ„ç´ æè¡¨
creative_assets
â”œâ”€â”€ id (UUID ä¸»é”®)
â”œâ”€â”€ task_id (ä»»åŠ¡ ID, å¤–é”®)
â”œâ”€â”€ image_url (å›¾ç‰‡ URL)
â”œâ”€â”€ thumbnail_url (ç¼©ç•¥å›¾ URL)
â”œâ”€â”€ format (å°ºå¯¸è§„æ ¼)
â”œâ”€â”€ variant_index (å˜ä½“ç´¢å¼•)
â”œâ”€â”€ prompt_used (ç”Ÿæˆæç¤ºè¯)
â”œâ”€â”€ style_used (ä½¿ç”¨é£æ ¼)
â”œâ”€â”€ quality_score (è´¨é‡è¯„åˆ†)
â”œâ”€â”€ predicted_ctr (é¢„æµ‹ CTR)
â”œâ”€â”€ nsfw_score (NSFW è¯„åˆ†)
â””â”€â”€ timestamps

-- å®éªŒè¡¨
experiments
â”œâ”€â”€ id (UUID ä¸»é”®)
â”œâ”€â”€ name (å®éªŒåç§°)
â”œâ”€â”€ product_name (äº§å“åç§°)
â”œâ”€â”€ status (å®éªŒçŠ¶æ€: draft/active/paused/archived)
â”œâ”€â”€ start_at (å¼€å§‹æ—¶é—´)
â”œâ”€â”€ end_at (ç»“æŸæ—¶é—´)
â””â”€â”€ timestamps

-- å®éªŒå˜ä½“è¡¨
experiment_variants
â”œâ”€â”€ id (è‡ªå¢ä¸»é”®)
â”œâ”€â”€ experiment_id (å®éªŒ ID, å¤–é”®)
â”œâ”€â”€ creative_id (ç´ æ ID)
â”œâ”€â”€ weight (æƒé‡ 0-1)
â”œâ”€â”€ bucket_start (åˆ†æ¡¶èµ·å§‹ 0-10000)
â”œâ”€â”€ bucket_end (åˆ†æ¡¶ç»“æŸ 0-10000)
â”œâ”€â”€ title, product_name, image_url, cta_text, selling_points
â””â”€â”€ timestamps

-- å®éªŒæŒ‡æ ‡è¡¨
experiment_metrics
â”œâ”€â”€ id (è‡ªå¢ä¸»é”®)
â”œâ”€â”€ experiment_id (å®éªŒ ID)
â”œâ”€â”€ creative_id (ç´ æ ID)
â”œâ”€â”€ impressions (æ›å…‰æ•°)
â”œâ”€â”€ clicks (ç‚¹å‡»æ•°)
â”œâ”€â”€ ctr (ç‚¹å‡»ç‡)
â””â”€â”€ updated_at

-- æ¨¡å‹è¿½è¸ªè¡¨
model_traces
â”œâ”€â”€ id (è‡ªå¢ä¸»é”®)
â”œâ”€â”€ trace_id (è¿½è¸ª ID, å”¯ä¸€ç´¢å¼•)
â”œâ”€â”€ model_name (æ¨¡å‹åç§°)
â”œâ”€â”€ model_version (æ¨¡å‹ç‰ˆæœ¬)
â”œâ”€â”€ product_name (äº§å“åç§°)
â”œâ”€â”€ status (çŠ¶æ€: success/failed/running)
â”œâ”€â”€ duration_ms (è€—æ—¶æ¯«ç§’)
â”œâ”€â”€ start_at, end_at (æ—¶é—´èŒƒå›´)
â”œâ”€â”€ source (æ¥æº: experiment/task/user)
â”œâ”€â”€ input_preview (è¾“å…¥é¢„è§ˆ)
â”œâ”€â”€ output_preview (è¾“å‡ºé¢„è§ˆ)
â”œâ”€â”€ error_message (é”™è¯¯ä¿¡æ¯)
â””â”€â”€ timestamps

-- æ¨¡å‹è¿½è¸ªæ­¥éª¤è¡¨
model_trace_steps
â”œâ”€â”€ id (è‡ªå¢ä¸»é”®)
â”œâ”€â”€ trace_id (è¿½è¸ª ID, å¤–é”®)
â”œâ”€â”€ step_name (æ­¥éª¤åç§°)
â”œâ”€â”€ component (ç»„ä»¶åç§°)
â”œâ”€â”€ status (çŠ¶æ€)
â”œâ”€â”€ duration_ms (è€—æ—¶æ¯«ç§’)
â”œâ”€â”€ start_at, end_at
â”œâ”€â”€ input_preview, output_preview
â”œâ”€â”€ error_message
â”œâ”€â”€ extra (æ‰©å±•ä¿¡æ¯ JSON)
â””â”€â”€ timestamps
```

**ç´¢å¼•ç­–ç•¥:**
- `creative_tasks`: status, user_id, created_at
- `creative_assets`: task_id, format, created_at
- `experiments`: status, created_at
- `experiment_variants`: experiment_id, creative_id
- `experiment_metrics`: experiment_id, creative_id
- `model_traces`: trace_id (å”¯ä¸€), model_name, product_name, status

#### æ•°æ®åº“ ER å…³ç³»å›¾

å±•ç¤ºæ ¸å¿ƒè¡¨ä¹‹é—´çš„å…³è”å…³ç³»ã€‚

```mermaid
erDiagram
    USERS ||--o{ CREATIVE_TASKS : creates
    USERS ||--o{ PROJECTS : owns
    PROJECTS ||--o{ CREATIVE_TASKS : contains

    CREATIVE_TASKS ||--o{ CREATIVE_ASSETS : generates
    CREATIVE_TASKS {
        uuid id PK
        uint user_id FK
        uint project_id FK
        string product_name
        json selling_points
        json requested_formats
        int num_variants
        string status
        timestamp created_at
    }

    CREATIVE_ASSETS {
        uuid id PK
        uuid task_id FK
        string image_url
        string thumbnail_url
        string format
        int variant_index
        float quality_score
        timestamp created_at
    }

    EXPERIMENTS ||--o{ EXPERIMENT_VARIANTS : contains
    EXPERIMENT_VARIANTS ||--|| CREATIVE_ASSETS : uses
    EXPERIMENTS {
        uuid id PK
        string name
        string product_name
        string status
        timestamp start_at
        timestamp end_at
    }

    EXPERIMENT_VARIANTS {
        uint id PK
        uint experiment_id FK
        uint creative_id FK
        float weight
        int bucket_start
        int bucket_end
    }

    EXPERIMENTS ||--o{ EXPERIMENT_METRICS : tracks
    EXPERIMENT_METRICS {
        uint id PK
        uint experiment_id FK
        uint creative_id FK
        int impressions
        int clicks
        float ctr
    }

    MODEL_TRACES ||--o{ MODEL_TRACE_STEPS : contains
    MODEL_TRACES {
        uint id PK
        string trace_id UK
        string model_name
        string status
        int duration_ms
        timestamp start_at
    }

    MODEL_TRACE_STEPS {
        uint id PK
        string trace_id FK
        string step_name
        string component
        int duration_ms
    }

    USERS {
        uint id PK
        string name
        string email
        timestamp created_at
    }

    PROJECTS {
        uint id PK
        uint user_id FK
        string name
        string description
    }
```

### æ¨¡å‹è°ƒç”¨è¿½è¸ªæ—¶åºå›¾

å±•ç¤º AI æ¨¡å‹è°ƒç”¨çš„å®Œæ•´é“¾è·¯è¿½è¸ªæµç¨‹ï¼Œä»è¯·æ±‚å‘èµ·åˆ°å“åº”è®°å½•ã€‚

```mermaid
sequenceDiagram
    participant User as ç”¨æˆ·
    participant API as API Handler
    participant Service as Service Layer
    participant Tracer as Tracer
    participant AI as AI Service
    participant DB as Database

    User->>API: è¯·æ±‚ç”Ÿæˆåˆ›æ„
    API->>Service: è°ƒç”¨ç”ŸæˆæœåŠ¡
    Service->>Tracer: åˆ›å»º Trace<br/>trace_id=xxx<br/>status=running
    Tracer->>DB: æ’å…¥ ModelTrace

    rect rgb(230, 245, 255)
        Note over Service,AI: æ–‡æ¡ˆç”Ÿæˆæ­¥éª¤
        Service->>Tracer: å¼€å§‹æ­¥éª¤ 1<br/>step_name=æ–‡æ¡ˆç”Ÿæˆ
        Tracer->>DB: æ’å…¥ TraceStep<br/>status=running
        Service->>AI: è°ƒç”¨é€šä¹‰åƒé—®<br/>ç”Ÿæˆæ–‡æ¡ˆå€™é€‰
        AI-->>Service: è¿”å›æ–‡æ¡ˆç»“æœ
        Service->>Tracer: å®Œæˆæ­¥éª¤ 1<br/>duration=800ms
        Tracer->>DB: æ›´æ–° TraceStep<br/>status=success
    end

    rect rgb(255, 243, 224)
        Note over Service,AI: å›¾åƒç”Ÿæˆæ­¥éª¤
        Service->>Tracer: å¼€å§‹æ­¥éª¤ 2<br/>step_name=å›¾åƒç”Ÿæˆ
        Tracer->>DB: æ’å…¥ TraceStep<br/>status=running
        Service->>AI: è°ƒç”¨é€šä¹‰ä¸‡ç›¸<br/>ç”Ÿæˆå›¾ç‰‡
        AI-->>Service: è¿”å›å›¾ç‰‡ URL
        Service->>Tracer: å®Œæˆæ­¥éª¤ 2<br/>duration=2500ms
        Tracer->>DB: æ›´æ–° TraceStep<br/>status=success
    end

    Service->>Tracer: å®Œæˆ Trace<br/>total_duration=3300ms
    Tracer->>DB: æ›´æ–° ModelTrace<br/>status=success
    Service-->>API: è¿”å›ç”Ÿæˆç»“æœ
    API-->>User: å“åº”æˆåŠŸ

    Note over User,DB: æ‰€æœ‰æ­¥éª¤è€—æ—¶å’ŒçŠ¶æ€å·²è®°å½•<br/>å¯é€šè¿‡ /model_traces API æŸ¥è¯¢
```

## é¡¹ç›®ç»“æ„

```
ads-creative-gen-platform/
â”œâ”€â”€ cmd/                          # å‘½ä»¤è¡Œå·¥å…·
â”‚   â””â”€â”€ migrate/                 # æ•°æ®åº“è¿ç§»å·¥å…·
â”‚       â””â”€â”€ main.go              # è¿ç§»è„šæœ¬å…¥å£
â”‚
â”œâ”€â”€ config/                      # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ config.go                # é…ç½®åŠ è½½å™¨
â”‚   â””â”€â”€ sql/                     # SQL è¿ç§»æ–‡ä»¶
â”‚
â”œâ”€â”€ internal/                    # å†…éƒ¨åŒ… (ä¸å¯¹å¤–æš´éœ²)
â”‚   â”œâ”€â”€ handlers/                # HTTP å¤„ç†å™¨ (Controller å±‚)
â”‚   â”‚   â”œâ”€â”€ creative_handler.go  # åˆ›æ„ç”Ÿæˆæ¥å£
â”‚   â”‚   â”œâ”€â”€ experiment_handler.go # å®éªŒç®¡ç†æ¥å£
â”‚   â”‚   â”œâ”€â”€ trace_handler.go     # æ¨¡å‹è¿½è¸ªæ¥å£
â”‚   â”‚   â””â”€â”€ dto.go               # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”‚
â”‚   â”œâ”€â”€ services/                # ä¸šåŠ¡é€»è¾‘å±‚ (Service å±‚)
â”‚   â”‚   â”œâ”€â”€ copywriting_service.go  # æ–‡æ¡ˆç”ŸæˆæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ creative_service.go     # åˆ›æ„ç”ŸæˆæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ experiment_service.go   # å®éªŒç®¡ç†æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ qwen_client.go          # é€šä¹‰åƒé—®å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ tongyi_client.go        # é€šä¹‰ä¸‡ç›¸å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ qiniu_service.go        # ä¸ƒç‰›äº‘æœåŠ¡
â”‚   â”‚   â””â”€â”€ delete_task.go          # ä»»åŠ¡åˆ é™¤æœåŠ¡
â”‚   â”‚
â”‚   â”œâ”€â”€ models/                  # æ•°æ®æ¨¡å‹ (Model å±‚)
â”‚   â”‚   â”œâ”€â”€ base.go              # åŸºç¡€æ¨¡å‹ (UUIDModel, Timestamps)
â”‚   â”‚   â”œâ”€â”€ creative.go          # åˆ›æ„ç›¸å…³æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ experiment.go        # å®éªŒç›¸å…³æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ trace.go             # è¿½è¸ªç›¸å…³æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ user.go              # ç”¨æˆ·æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ project.go           # é¡¹ç›®æ¨¡å‹
â”‚   â”‚   â””â”€â”€ tag.go               # æ ‡ç­¾æ¨¡å‹
â”‚   â”‚
â”‚   â”œâ”€â”€ middleware/              # ä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ cors.go              # CORS è·¨åŸŸé…ç½®
â”‚   â”‚
â”‚   â””â”€â”€ tracing/                 # è¿½è¸ªç³»ç»Ÿ
â”‚       â”œâ”€â”€ tracer.go            # è¿½è¸ªå™¨
â”‚       â””â”€â”€ trace_service.go     # è¿½è¸ªæœåŠ¡
â”‚
â”œâ”€â”€ pkg/                         # å…¬å…±åŒ… (å¯å¯¹å¤–æš´éœ²)
â”‚   â””â”€â”€ database/                # æ•°æ®åº“è¿æ¥å±‚
â”‚       â””â”€â”€ database.go          # æ•°æ®åº“åˆå§‹åŒ–
â”‚
â”œâ”€â”€ web/                         # React å‰ç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ pages/              # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ DashboardPage.tsx          # é¦–é¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ CreativeGeneratorPage.tsx  # åˆ›æ„ç”Ÿæˆé¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ TasksPage.tsx              # ä»»åŠ¡åˆ—è¡¨é¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ AssetsPage.tsx             # ç´ æåº“é¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ ExperimentsPage.tsx        # å®éªŒåˆ—è¡¨é¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ ExperimentCreatePage.tsx   # åˆ›å»ºå®éªŒé¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ TracePage.tsx              # æ¨¡å‹è¿½è¸ªé¡µ
â”‚   â”‚   â”‚   â””â”€â”€ PluginPreviewPage.tsx      # æ’ä»¶é¢„è§ˆé¡µ
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ components/         # å¯å¤ç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ services/           # API å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ types/              # TypeScript ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ i18n.tsx            # å›½é™…åŒ–é…ç½®
â”‚   â”‚   â”œâ”€â”€ App.tsx             # åº”ç”¨å…¥å£
â”‚   â”‚   â””â”€â”€ main.tsx            # æ¸²æŸ“å…¥å£
â”‚   â”‚
â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â””â”€â”€ experiment-widget.js # å®éªŒæ’ä»¶è„šæœ¬
â”‚   â”‚
â”‚   â”œâ”€â”€ dist/                   # æ„å»ºäº§ç‰© (ç”±åç«¯æ‰˜ç®¡)
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â””â”€â”€ vite.config.js
â”‚
â”œâ”€â”€ docs/                       # æ–‡æ¡£ä¸­å¿ƒ
â”‚   â”œâ”€â”€ README.md               # æ–‡æ¡£ç´¢å¼•
â”‚   â”œâ”€â”€ api-reference.md        # API æ¥å£æ–‡æ¡£
â”‚   â”œâ”€â”€ database.md             # æ•°æ®åº“è®¾è®¡æ–‡æ¡£
â”‚   â”œâ”€â”€ database-schema.sql     # æ•°æ®åº“ Schema
â”‚   â”œâ”€â”€ guides/                 # æŒ‡å—æ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ development.md      # å¼€å‘æŒ‡å—
â”‚   â”‚   â””â”€â”€ deployment.md       # éƒ¨ç½²æŒ‡å—
â”‚   â””â”€â”€ design/                 # åŠŸèƒ½è®¾è®¡æ–‡æ¡£
â”‚       â”œâ”€â”€ copywriting-feature.md
â”‚       â”œâ”€â”€ experiment-feature.md
â”‚       â”œâ”€â”€ model-trace-page.md
â”‚       â””â”€â”€ plugin-widget.md
â”‚
â”œâ”€â”€ scripts/                    # ç®¡ç†è„šæœ¬
â”‚   â”œâ”€â”€ start.sh               # å¯åŠ¨æœåŠ¡
â”‚   â”œâ”€â”€ stop.sh                # åœæ­¢æœåŠ¡
â”‚   â””â”€â”€ status.sh              # æŸ¥çœ‹çŠ¶æ€
â”‚
â”œâ”€â”€ main.go                    # ç¨‹åºå…¥å£
â”œâ”€â”€ Dockerfile                 # Docker é•œåƒé…ç½® (å¤šé˜¶æ®µæ„å»º)
â”œâ”€â”€ .env.example              # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ go.mod                    # Go ä¾èµ–ç®¡ç†
â””â”€â”€ go.sum                    # Go ä¾èµ–é”å®š
```

**ç›®å½•è®¾è®¡åŸåˆ™:**
- **cmd/** - å¯æ‰§è¡Œç¨‹åºå…¥å£
- **internal/** - ç§æœ‰ä»£ç ,ä¸å¯¹å¤–æš´éœ²
- **pkg/** - å¯å¤ç”¨çš„å…¬å…±åº“
- **web/** - å‰ç«¯é¡¹ç›®,å®Œå…¨ç‹¬ç«‹
- **docs/** - é¡¹ç›®æ–‡æ¡£é›†ä¸­ç®¡ç†
- **scripts/** - è¿ç»´è„šæœ¬

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

**å¿…éœ€:**
- **Go**: 1.20 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Node.js**: 18 æˆ–æ›´é«˜ç‰ˆæœ¬
- **æ•°æ®åº“**: PostgreSQL 14+ æˆ– MySQL 8.0+

**å¯é€‰:**
- **Docker**: ç”¨äºå®¹å™¨åŒ–éƒ¨ç½²
- **Make**: ç”¨äºè¿è¡Œ Makefile å‘½ä»¤

### 1. å…‹éš†é¡¹ç›®

```bash
git clone <your-repo-url>
cd ads-creative-gen-platform
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘é…ç½®æ–‡ä»¶ (ä½¿ç”¨ä½ å–œæ¬¢çš„ç¼–è¾‘å™¨)
vim .env  # æˆ– nano .env
```

**å¿…éœ€é…ç½®é¡¹:**

```bash
# åº”ç”¨é…ç½®
APP_MODE=debug              # debug: å¼€å‘æ¨¡å¼, release: ç”Ÿäº§æ¨¡å¼
HTTP_PORT=:4000             # HTTP æœåŠ¡ç«¯å£

# æ•°æ®åº“é…ç½® (PostgreSQL ç¤ºä¾‹)
DB_TYPE=postgres            # postgres æˆ– mysql
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=your_password
DB_NAME=ads_creative_gen_platform
DB_CHARSET=utf8

# é€šä¹‰ API é…ç½®
TONGYI_API_KEY=sk-xxxxx    # é˜¿é‡Œäº‘ DashScope API Key
TONGYI_IMAGE_MODEL=wanx-v1  # å›¾åƒç”Ÿæˆæ¨¡å‹
TONGYI_LLM_MODEL=qwen-turbo # æ–‡æ¡ˆç”Ÿæˆæ¨¡å‹

# ä¸ƒç‰›äº‘é…ç½®
QINIU_ACCESS_KEY=your_access_key
QINIU_SECRET_KEY=your_secret_key
QINIU_BUCKET=your_bucket_name
QINIU_DOMAIN=               # å¯é€‰: è‡ªå®šä¹‰åŸŸå
QINIU_PUBLIC_CLOUD_DOMAIN=  # å¯é€‰: å…¬æœ‰äº‘åŸŸå
QINIU_REGION=cn-south-1     # å­˜å‚¨åŒºåŸŸ
QINIU_BASE_PATH=s3/         # å­˜å‚¨è·¯å¾„å‰ç¼€
```

**è·å– API Key:**
- **é€šä¹‰ API Key**: [é˜¿é‡Œäº‘ DashScope æ§åˆ¶å°](https://dashscope.console.aliyun.com/)
- **ä¸ƒç‰›äº‘å¯†é’¥**: [ä¸ƒç‰›äº‘å¯†é’¥ç®¡ç†](https://portal.qiniu.com/user/key)

### 3. åˆå§‹åŒ–æ•°æ®åº“

**PostgreSQL:**

```bash
# åˆ›å»ºæ•°æ®åº“
psql -U postgres -c "CREATE DATABASE ads_creative_gen_platform;"

# è¿è¡Œæ•°æ®åº“è¿ç§»
go run cmd/migrate/main.go -action migrate

# (å¯é€‰) æ·»åŠ é»˜è®¤æ•°æ®
go run cmd/migrate/main.go -action seed
```

**è¿ç§»å‘½ä»¤è¯´æ˜:**
- `migrate` - åˆ›å»º/æ›´æ–°è¡¨ç»“æ„ (å®‰å…¨,ä¸ä¼šåˆ é™¤æ•°æ®)
- `seed` - æ·»åŠ é»˜è®¤æ•°æ® (ç®¡ç†å‘˜è´¦å·ã€æ ‡ç­¾ç­‰)
- `reset` - âš ï¸ é‡ç½®æ•°æ®åº“ (åˆ é™¤æ‰€æœ‰æ•°æ®å¹¶é‡æ–°åˆå§‹åŒ–)

### 4. å¯åŠ¨åç«¯æœåŠ¡

```bash
# å®‰è£… Go ä¾èµ–
go mod download

# å¯åŠ¨æœåŠ¡
go run main.go
```

æˆåŠŸåä¼šæ˜¾ç¤º:

```
ğŸš€ Server starting on :4000
ğŸ“– API Docs: http://localhost:4000/api/v1/ping
ğŸ’š Health Check: http://localhost:4000/health
```

### 5. æ„å»ºå¹¶å¯åŠ¨å‰ç«¯

**å¼€å‘æ¨¡å¼ (æ¨è):**

```bash
cd web

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨ (çƒ­é‡è½½)
npm run dev
```

å‰ç«¯å°†è¿è¡Œåœ¨ `http://localhost:3001`

**ç”Ÿäº§æ¨¡å¼:**

```bash
cd web

# å®‰è£…ä¾èµ–
npm install

# æ„å»ºå‰ç«¯
npm run build
```

æ„å»ºäº§ç‰©ä¼šç”Ÿæˆåˆ° `web/dist/`,ç„¶åè®¿é—®åç«¯æœåŠ¡ `http://localhost:4000` å³å¯ã€‚

### 6. è®¿é—®åº”ç”¨

**å¼€å‘æ¨¡å¼ (å‰åç«¯åˆ†ç¦»):**
- å‰ç«¯: http://localhost:3001
- åç«¯ API: http://localhost:4000/api/v1
- å¥åº·æ£€æŸ¥: http://localhost:4000/health

**ç”Ÿäº§æ¨¡å¼ (å‰åç«¯ä¸€ä½“åŒ–):**
- åº”ç”¨é¦–é¡µ: http://localhost:4000
- API æ¥å£: http://localhost:4000/api/v1
- å¥åº·æ£€æŸ¥: http://localhost:4000/health

### 7. ä½¿ç”¨ç®¡ç†è„šæœ¬ (å¯é€‰)

é¡¹ç›®æä¾›äº†ä¾¿æ·çš„ç®¡ç†è„šæœ¬:

```bash
# å¯åŠ¨æœåŠ¡ (è‡ªåŠ¨æ£€æŸ¥æ•°æ®åº“ã€è¿è¡Œè¿ç§»)
./scripts/start.sh

# åœæ­¢æœåŠ¡
./scripts/stop.sh

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
./scripts/status.sh
```

## ç¯å¢ƒé…ç½®

### å®Œæ•´ç¯å¢ƒå˜é‡è¯´æ˜

```bash
# ==========================================
# åº”ç”¨é…ç½®
# ==========================================
APP_MODE=debug              # debug: å¼€å‘æ¨¡å¼, release: ç”Ÿäº§æ¨¡å¼
HTTP_PORT=:4000             # HTTP æœåŠ¡ç«¯å£ (æ ¼å¼: :ç«¯å£å·)

# ==========================================
# æ•°æ®åº“é…ç½®
# ==========================================
DB_TYPE=postgres            # æ•°æ®åº“ç±»å‹: postgres æˆ– mysql
DB_HOST=localhost           # æ•°æ®åº“ä¸»æœº
DB_PORT=5432                # æ•°æ®åº“ç«¯å£ (PostgreSQL: 5432, MySQL: 3306)
DB_USER=postgres            # æ•°æ®åº“ç”¨æˆ·å
DB_PASSWORD=your_password   # æ•°æ®åº“å¯†ç 
DB_NAME=ads_creative_gen_platform  # æ•°æ®åº“åç§°
DB_CHARSET=utf8             # å­—ç¬¦é›† (MySQL: utf8mb4, PostgreSQL: utf8)

# ==========================================
# é˜¿é‡Œäº‘é€šä¹‰ API é…ç½®
# ==========================================
TONGYI_API_KEY=sk-xxxxx     # DashScope API Key
TONGYI_IMAGE_MODEL=wanx-v1  # å›¾åƒç”Ÿæˆæ¨¡å‹: wanx-v1, wanx-lite-v1
TONGYI_LLM_MODEL=qwen-turbo # æ–‡æ¡ˆç”Ÿæˆæ¨¡å‹: qwen-turbo, qwen-plus, qwen-max

# ==========================================
# ä¸ƒç‰›äº‘å­˜å‚¨é…ç½®
# ==========================================
QINIU_ACCESS_KEY=your_access_key  # ä¸ƒç‰›äº‘ AccessKey
QINIU_SECRET_KEY=your_secret_key  # ä¸ƒç‰›äº‘ SecretKey
QINIU_BUCKET=your_bucket_name     # å­˜å‚¨ç©ºé—´åç§°
QINIU_DOMAIN=                     # è‡ªå®šä¹‰ CDN åŸŸå (å¯é€‰)
QINIU_PUBLIC_CLOUD_DOMAIN=        # å…¬æœ‰äº‘é»˜è®¤åŸŸå (å¯é€‰)
QINIU_REGION=cn-south-1           # å­˜å‚¨åŒºåŸŸ: cn-south-1 (åå—), cn-east-2 (åä¸œ)
QINIU_BASE_PATH=s3/               # å­˜å‚¨è·¯å¾„å‰ç¼€
```

### æ•°æ®åº“åˆ‡æ¢

**ä½¿ç”¨ PostgreSQL (æ¨è):**

```bash
DB_TYPE=postgres
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=postgres
DB_NAME=ads_creative_gen_platform
DB_CHARSET=utf8
```

## éƒ¨ç½²æŒ‡å—

### æ–¹å¼ä¸€: Docker éƒ¨ç½² (æ¨è)

é¡¹ç›®æä¾›äº†å¤šé˜¶æ®µæ„å»ºçš„ Dockerfile,å¯ä»¥å®ç°å‰åç«¯ä¸€ä½“åŒ–éƒ¨ç½²ã€‚

**æ„å»ºé•œåƒ:**

```bash
# æ„å»º Docker é•œåƒ
docker build -t ads-creative-gen-platform:latest .

# è¿è¡Œå®¹å™¨
docker run -d \
  --name ads-platform \
  -p 4000:4000 \
  --env-file .env \
  ads-creative-gen-platform:latest

# æŸ¥çœ‹æ—¥å¿—
docker logs -f ads-platform
```

**Docker å¤šé˜¶æ®µæ„å»ºæµç¨‹å›¾:**

å±•ç¤ºå‰åç«¯åˆ†ç¦»æ„å»ºã€æœ€ç»ˆæ•´åˆä¸ºå•ä¸€è¿è¡Œæ—¶é•œåƒçš„å®Œæ•´æµç¨‹ã€‚

```mermaid
graph LR
    subgraph Stage1["é˜¶æ®µ 1: å‰ç«¯æ„å»º"]
        S1_Base["Node.js 20 Alpine"]
        S1_Copy["å¤åˆ¶ package.json"]
        S1_Install["npm ci å®‰è£…ä¾èµ–"]
        S1_Build["npm run build"]
        S1_Output["web/dist/"]

        S1_Base --> S1_Copy --> S1_Install --> S1_Build --> S1_Output
    end

    subgraph Stage2["é˜¶æ®µ 2: åç«¯æ„å»º"]
        S2_Base["Go 1.22 Alpine"]
        S2_Deps["go mod download"]
        S2_CopyFront["å¤åˆ¶å‰ç«¯äº§ç‰©"]
        S2_Build["go build"]
        S2_Output["main äºŒè¿›åˆ¶"]

        S2_Base --> S2_Deps --> S2_CopyFront --> S2_Build --> S2_Output
    end

    subgraph Stage3["é˜¶æ®µ 3: è¿è¡Œæ—¶"]
        S3_Base["Alpine Latest"]
        S3_Runtime["å®‰è£…è¿è¡Œæ—¶ä¾èµ–<br/>ca-certificates, tzdata"]
        S3_Copy["å¤åˆ¶ main + web/dist/"]
        S3_User["åˆ›å»ºé root ç”¨æˆ·"]
        S3_Final["æœ€ç»ˆé•œåƒ<br/>~50MB"]

        S3_Base --> S3_Runtime --> S3_Copy --> S3_User --> S3_Final
    end

    S1_Output -.->|å¤åˆ¶åˆ°é˜¶æ®µ2| S2_CopyFront
    S1_Output -.->|å¤åˆ¶åˆ°é˜¶æ®µ3| S3_Copy
    S2_Output -.->|å¤åˆ¶åˆ°é˜¶æ®µ3| S3_Copy

    style Stage1 fill:#e3f2fd
    style Stage2 fill:#f3e5f5
    style Stage3 fill:#e8f5e9
    style S3_Final fill:#c8e6c9,stroke:#4caf50,stroke-width:3px
```

**ä¼˜åŠ¿:**
- âœ… é•œåƒä½“ç§¯å° (~50MB)
- âœ… å®‰å…¨æ€§é«˜ (é root ç”¨æˆ·)
- âœ… è‡ªåŠ¨å¤šé˜¶æ®µæ„å»º
- âœ… åŒ…å«å¥åº·æ£€æŸ¥
- âœ… å‰åç«¯ä¸€ä½“åŒ–éƒ¨ç½²

### æ–¹å¼äºŒ: äº‘å¹³å°éƒ¨ç½²

#### Railway

Railway æ˜¯ä¸€ä¸ªé›¶é…ç½®çš„äº‘éƒ¨ç½²å¹³å°ã€‚

```bash
# 1. å®‰è£… Railway CLI
npm install -g @railway/cli

# 2. ç™»å½•
railway login

# 3. åˆå§‹åŒ–é¡¹ç›®
railway init

# 4. éƒ¨ç½²
railway up
```

#### Render

Render æ”¯æŒä» Dockerfile è‡ªåŠ¨éƒ¨ç½²ã€‚

**æ­¥éª¤:**
1. åœ¨ Render åˆ›å»ºæ–°çš„ Web Service
2. è¿æ¥ GitHub ä»“åº“
3. é€‰æ‹© Dockerfile æ„å»º
4. é…ç½®ç¯å¢ƒå˜é‡
5. ç‚¹å‡»éƒ¨ç½²


## API æ¥å£

### è®¤è¯

å½“å‰ç‰ˆæœ¬æš‚æœªå®ç°è®¤è¯ç³»ç»Ÿ,æ‰€æœ‰æ¥å£å‡å¯ç›´æ¥è®¿é—®ã€‚

### åŸºç¡€æ¥å£

#### å¥åº·æ£€æŸ¥

```http
GET /health
```

**å“åº”:**

```json
{
  "status": "ok",
  "service": "ads-creative-platform"
}
```

#### Ping

```http
GET /api/v1/ping
```

**å“åº”:**

```json
{
  "message": "pong"
}
```

### æ–‡æ¡ˆç”Ÿæˆæ¥å£

#### ç”Ÿæˆæ–‡æ¡ˆå€™é€‰

```http
POST /api/v1/copywriting/generate
Content-Type: application/json

{
  "product_name": "å¤å­£æ¸…å‡‰Tæ¤"
}
```

**å“åº”:**

```json
{
  "cta_candidates": [
    "ç«‹å³æŠ¢è´­",
    "é©¬ä¸Šè´­ä¹°",
    "é™æ—¶ç‰¹æƒ "
  ],
  "selling_point_candidates": [
    "çº¯æ£‰é€æ°”ï¼Œæ¸…å‡‰ä¸€å¤",
    "å¸æ±—é€Ÿå¹²ï¼Œèˆ’é€‚æ— ç—•",
    "ç»å…¸è®¾è®¡ï¼Œç™¾æ­æ—¶å°š",
    "ç²¾é€‰é¢æ–™ï¼Œäº²è‚¤æŸ”è½¯",
    "å¤æ—¥å¿…å¤‡ï¼Œæ¸…çˆ½éšè¡Œ",
    "å¤šè‰²å¯é€‰ï¼Œå½°æ˜¾ä¸ªæ€§"
  ]
}
```

#### ç¡®è®¤æ–‡æ¡ˆå¹¶å¯åŠ¨åˆ›æ„ç”Ÿæˆ

```http
POST /api/v1/copywriting/confirm
Content-Type: application/json

{
  "product_name": "å¤å­£æ¸…å‡‰Tæ¤",
  "cta": "ç«‹å³æŠ¢è´­",
  "selling_point": "çº¯æ£‰é€æ°”ï¼Œæ¸…å‡‰ä¸€å¤",
  "requested_formats": ["1:1", "9:16", "16:9"],
  "num_variants": 3,
  "selected_cta_index": 0,
  "selected_sp_indexes": [0, 1]
}
```

**å“åº”:**

```json
{
  "task_id": "550e8400-e29b-41d4-a716-446655440000",
  "status": "pending",
  "message": "ä»»åŠ¡å·²åˆ›å»º,å¼€å§‹ç”Ÿæˆåˆ›æ„"
}
```

### åˆ›æ„ç”Ÿæˆæ¥å£

#### ç›´æ¥ç”Ÿæˆåˆ›æ„ (è·³è¿‡æ–‡æ¡ˆç”Ÿæˆ)

```http
POST /api/v1/creative/generate
Content-Type: application/json

{
  "title": "å¤å­£Tæ¤ä¿ƒé”€",
  "product_name": "å¤å­£æ¸…å‡‰Tæ¤",
  "selling_points": ["çº¯æ£‰é€æ°”", "å¸æ±—é€Ÿå¹²"],
  "cta_text": "ç«‹å³æŠ¢è´­",
  "requested_formats": ["1:1", "9:16"],
  "num_variants": 2
}
```

**å“åº”:**

```json
{
  "task_id": "550e8400-e29b-41d4-a716-446655440000",
  "status": "pending"
}
```

#### æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€

```http
GET /api/v1/creative/task/{task_id}
```

**å“åº”:**

```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "title": "å¤å­£Tæ¤ä¿ƒé”€",
  "product_name": "å¤å­£æ¸…å‡‰Tæ¤",
  "status": "completed",
  "progress": 100,
  "requested_formats": ["1:1", "9:16"],
  "num_variants": 2,
  "first_asset_url": "https://cdn.example.com/xxx.jpg",
  "assets": [
    {
      "id": "asset-uuid-1",
      "image_url": "https://cdn.example.com/xxx.jpg",
      "thumbnail_url": "https://cdn.example.com/xxx_thumb.jpg",
      "format": "1:1",
      "variant_index": 0,
      "quality_score": 0.85,
      "predicted_ctr": 0.12
    }
  ],
  "created_at": "2024-12-15T10:00:00Z",
  "completed_at": "2024-12-15T10:02:30Z"
}
```

**ä»»åŠ¡çŠ¶æ€:**
- `draft` - è‰ç¨¿ (ä»…æ–‡æ¡ˆç”Ÿæˆ)
- `pending` - å¾…å¤„ç†
- `queued` - å·²æ’é˜Ÿ
- `processing` - å¤„ç†ä¸­
- `completed` - å·²å®Œæˆ
- `failed` - å¤±è´¥
- `cancelled` - å·²å–æ¶ˆ

#### è·å–ä»»åŠ¡åˆ—è¡¨

```http
GET /api/v1/creative/tasks?page=1&page_size=10
```

**å“åº”:**

```json
{
  "tasks": [...],
  "pagination": {
    "page": 1,
    "page_size": 10,
    "total": 50
  }
}
```

#### åˆ é™¤ä»»åŠ¡

```http
DELETE /api/v1/creative/task/{task_id}
```

**å“åº”:**

```json
{
  "message": "ä»»åŠ¡åŠå…³è”ç´ æå·²åˆ é™¤"
}
```

### ç´ æç®¡ç†æ¥å£

#### è·å–ç´ æåˆ—è¡¨

```http
GET /api/v1/creative/assets?page=1&page_size=20&format=1:1
```

**æŸ¥è¯¢å‚æ•°:**
- `page` - é¡µç  (é»˜è®¤ 1)
- `page_size` - æ¯é¡µæ•°é‡ (é»˜è®¤ 20)
- `format` - å°ºå¯¸ç­›é€‰ (å¯é€‰: 1:1, 9:16, 16:9)

**å“åº”:**

```json
{
  "assets": [...],
  "pagination": {
    "page": 1,
    "page_size": 20,
    "total": 100
  }
}
```

### å®éªŒç®¡ç†æ¥å£

#### åˆ›å»ºå®éªŒ

```http
POST /api/v1/experiments
Content-Type: application/json

{
  "name": "å¤å­£Tæ¤å¹¿å‘Šæµ‹è¯•",
  "product_name": "å¤å­£æ¸…å‡‰Tæ¤",
  "variants": [
    {
      "creative_id": 1,
      "weight": 0.5
    },
    {
      "creative_id": 2,
      "weight": 0.5
    }
  ]
}
```

**å“åº”:**

```json
{
  "id": "exp-uuid",
  "name": "å¤å­£Tæ¤å¹¿å‘Šæµ‹è¯•",
  "status": "draft",
  "variants": [
    {
      "id": 1,
      "creative_id": 1,
      "weight": 0.5,
      "bucket_start": 0,
      "bucket_end": 5000
    },
    {
      "id": 2,
      "creative_id": 2,
      "weight": 0.5,
      "bucket_start": 5000,
      "bucket_end": 10000
    }
  ]
}
```

#### è·å–å®éªŒåˆ—è¡¨

```http
GET /api/v1/experiments?page=1&page_size=10
```

#### æ›´æ–°å®éªŒçŠ¶æ€

```http
POST /api/v1/experiments/{id}/status
Content-Type: application/json

{
  "status": "active"
}
```

**çŠ¶æ€å€¼:**
- `draft` - è‰ç¨¿
- `active` - è¿è¡Œä¸­
- `paused` - å·²æš‚åœ
- `archived` - å·²å½’æ¡£

#### åˆ†é…å˜ä½“ (åˆ†æµ)

```http
GET /api/v1/experiments/{id}/assign?user_id=user123
```

**å“åº”:**

```json
{
  "variant_id": 1,
  "creative_id": 1,
  "title": "å¤å­£æ¸…å‡‰Tæ¤",
  "product_name": "å¤å­£æ¸…å‡‰Tæ¤",
  "image_url": "https://cdn.example.com/xxx.jpg",
  "cta_text": "ç«‹å³æŠ¢è´­",
  "selling_points": ["çº¯æ£‰é€æ°”", "å¸æ±—é€Ÿå¹²"]
}
```

**åˆ†æµç®—æ³•:**
```
bucket = hash(user_id) % 10000
åŒ¹é… bucket_start <= bucket < bucket_end çš„å˜ä½“
```

#### è®°å½•æ›å…‰

```http
POST /api/v1/experiments/{id}/hit
Content-Type: application/json

{
  "user_id": "user123",
  "variant_id": 1
}
```

**å“åº”:**

```json
{
  "message": "æ›å…‰å·²è®°å½•"
}
```

#### è®°å½•ç‚¹å‡»

```http
POST /api/v1/experiments/{id}/click
Content-Type: application/json

{
  "user_id": "user123",
  "variant_id": 1
}
```

**å“åº”:**

```json
{
  "message": "ç‚¹å‡»å·²è®°å½•"
}
```

#### æŸ¥çœ‹å®éªŒæŒ‡æ ‡

```http
GET /api/v1/experiments/{id}/metrics
```

**å“åº”:**

```json
{
  "experiment_id": "exp-uuid",
  "metrics": [
    {
      "creative_id": 1,
      "impressions": 10000,
      "clicks": 500,
      "ctr": 0.05
    },
    {
      "creative_id": 2,
      "impressions": 10000,
      "clicks": 600,
      "ctr": 0.06
    }
  ]
}
```

### æ¨¡å‹è¿½è¸ªæ¥å£

#### è·å–è¿½è¸ªåˆ—è¡¨

```http
GET /api/v1/model_traces?page=1&page_size=10
```

**å“åº”:**

```json
{
  "traces": [...],
  "pagination": {
    "page": 1,
    "page_size": 10,
    "total": 50
  }
}
```

#### è·å–è¿½è¸ªè¯¦æƒ…

```http
GET /api/v1/model_traces/{id}
```

**å“åº”:**

```json
{
  "id": 1,
  "trace_id": "trace-uuid",
  "model_name": "é€šä¹‰åƒé—®",
  "model_version": "qwen-turbo",
  "product_name": "å¤å­£æ¸…å‡‰Tæ¤",
  "status": "success",
  "duration_ms": 1500,
  "start_at": "2024-12-15T10:00:00Z",
  "end_at": "2024-12-15T10:00:01.5Z",
  "steps": [
    {
      "step_name": "æ–‡æ¡ˆç”Ÿæˆ",
      "component": "QwenClient",
      "status": "success",
      "duration_ms": 800,
      "input_preview": "äº§å“åç§°: å¤å­£æ¸…å‡‰Tæ¤",
      "output_preview": "CTA: ç«‹å³æŠ¢è´­; å–ç‚¹: ..."
    }
  ]
}
```

## å¼€å‘æŒ‡å—

### åç«¯å¼€å‘

#### é¡¹ç›®ç»“æ„çº¦å®š

- **handlers/** - ä»…è´Ÿè´£ HTTP è¯·æ±‚/å“åº”å¤„ç†,ä¸åŒ…å«ä¸šåŠ¡é€»è¾‘
- **services/** - æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å±‚,å¯è¢«å¤šä¸ª handler å¤ç”¨
- **models/** - æ•°æ®æ¨¡å‹å®šä¹‰,ä½¿ç”¨ GORM æ ‡ç­¾
- **pkg/** - å¯å¤ç”¨çš„å…¬å…±åº“ (å¦‚æ•°æ®åº“è¿æ¥)

#### æ·»åŠ æ–°æ¥å£

**1. å®šä¹‰æ•°æ®æ¨¡å‹ (internal/models/)**

```go
package models

type MyModel struct {
    UUIDModel
    Name   string `gorm:"type:varchar(255);not null" json:"name"`
    Status string `gorm:"type:varchar(20);default:'active'" json:"status"`
}

func (MyModel) TableName() string {
    return "my_models"
}
```

**2. åˆ›å»ºæœåŠ¡å±‚ (internal/services/)**

```go
package services

type MyService struct {
    db *gorm.DB
}

func NewMyService() *MyService {
    return &MyService{db: database.DB}
}

func (s *MyService) Create(data *models.MyModel) error {
    return s.db.Create(data).Error
}
```

**3. åˆ›å»ºå¤„ç†å™¨ (internal/handlers/)**

```go
package handlers

type MyHandler struct {
    service *services.MyService
}

func NewMyHandler() *MyHandler {
    return &MyHandler{
        service: services.NewMyService(),
    }
}

func (h *MyHandler) Create(c *gin.Context) {
    var req dto.CreateMyModelRequest
    if err := c.ShouldBindJSON(&req); err != nil {
        c.JSON(400, gin.H{"error": err.Error()})
        return
    }

    // è°ƒç”¨æœåŠ¡å±‚
    model := &models.MyModel{Name: req.Name}
    if err := h.service.Create(model); err != nil {
        c.JSON(500, gin.H{"error": err.Error()})
        return
    }

    c.JSON(200, model)
}
```

**4. æ³¨å†Œè·¯ç”± (main.go)**

```go
myHandler := handlers.NewMyHandler()
v1.POST("/my-models", myHandler.Create)
v1.GET("/my-models/:id", myHandler.Get)
```

#### æ•°æ®åº“è¿ç§»

**è‡ªåŠ¨è¿ç§» (å¼€å‘ç¯å¢ƒ):**

åœ¨ `pkg/database/database.go` ä¸­æ·»åŠ æ¨¡å‹:

```go
func InitializeDatabase() {
    // ...
    DB.AutoMigrate(
        &models.MyModel{}, // æ·»åŠ æ–°æ¨¡å‹
    )
}
```

**æ‰‹åŠ¨è¿ç§» (ç”Ÿäº§ç¯å¢ƒ):**

åœ¨ `cmd/migrate/main.go` ä¸­æ·»åŠ :

```go
func migrate() {
    database.DB.AutoMigrate(&models.MyModel{})
    log.Println("âœ… MyModel table migrated")
}
```

ç„¶åè¿è¡Œ:

```bash
go run cmd/migrate/main.go -action migrate
```

### å‰ç«¯å¼€å‘

#### é¡¹ç›®ç»“æ„çº¦å®š

- **pages/** - é¡µé¢ç»„ä»¶ (ä¸€ä¸ªè·¯ç”±å¯¹åº”ä¸€ä¸ªé¡µé¢)
- **components/** - å¯å¤ç”¨ç»„ä»¶
- **services/** - API å®¢æˆ·ç«¯å°è£…
- **types/** - TypeScript ç±»å‹å®šä¹‰

#### æ·»åŠ æ–°é¡µé¢

**1. åˆ›å»ºé¡µé¢ç»„ä»¶ (src/pages/MyPage.tsx)**

```tsx
import React from 'react';

const MyPage: React.FC = () => {
  return (
    <div>
      <h1>My Page</h1>
    </div>
  );
};

export default MyPage;
```

**2. æ³¨å†Œè·¯ç”± (src/App.tsx)**

```tsx
import MyPage from './pages/MyPage';

<Routes>
  <Route path="/my-page" element={<MyPage />} />
</Routes>
```

#### API è°ƒç”¨

**1. å®šä¹‰ç±»å‹ (src/types/index.ts)**

```typescript
export interface MyModel {
  id: string;
  name: string;
  status: string;
  created_at: string;
}
```

**2. åˆ›å»º API æœåŠ¡ (src/services/api.ts)**

```typescript
import axios from 'axios';
import { MyModel } from '../types';

const API_BASE = '/api/v1';

export const myApi = {
  create: async (data: { name: string }): Promise<MyModel> => {
    const res = await axios.post(`${API_BASE}/my-models`, data);
    return res.data;
  },

  get: async (id: string): Promise<MyModel> => {
    const res = await axios.get(`${API_BASE}/my-models/${id}`);
    return res.data;
  },
};
```

**3. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨**

```tsx
import { useEffect, useState } from 'react';
import { myApi } from '../services/api';
import { MyModel } from '../types';

const MyPage: React.FC = () => {
  const [data, setData] = useState<MyModel | null>(null);

  useEffect(() => {
    myApi.get('some-id').then(setData);
  }, []);

  return <div>{data?.name}</div>;
};
```

#### å›½é™…åŒ–

ä½¿ç”¨é¡¹ç›®å†…ç½®çš„ i18n ç³»ç»Ÿ:

```tsx
import { useI18n } from '../i18n';

const MyComponent: React.FC = () => {
  const { t, setLanguage } = useI18n();

  return (
    <div>
      <h1>{t('myPage.title')}</h1>
      <button onClick={() => setLanguage('en')}>English</button>
      <button onClick={() => setLanguage('zh')}>ä¸­æ–‡</button>
    </div>
  );
};
```

åœ¨ `src/i18n.tsx` ä¸­æ·»åŠ ç¿»è¯‘:

```typescript
const translations = {
  zh: {
    myPage: {
      title: 'æˆ‘çš„é¡µé¢',
    },
  },
  en: {
    myPage: {
      title: 'My Page',
    },
  },
};
```

### ä»£ç è§„èŒƒ

**Go ä»£ç è§„èŒƒ:**
- éµå¾ª [Effective Go](https://golang.org/doc/effective_go.html)
- ä½¿ç”¨ `gofmt` æ ¼å¼åŒ–ä»£ç 
- å¯¼å‡ºå‡½æ•°å’Œç±»å‹æ·»åŠ æ³¨é‡Š
- é”™è¯¯å¤„ç†ä¸è¦å¿½ç•¥

**TypeScript ä»£ç è§„èŒƒ:**
- ä½¿ç”¨ä¸¥æ ¼æ¨¡å¼ (`strict: true`)
- ç»„ä»¶ä½¿ç”¨å‡½æ•°å¼ç»„ä»¶ + Hooks
- é¿å…ä½¿ç”¨ `any`,å°½é‡å®šä¹‰ç±»å‹
- ä½¿ç”¨ ESLint å’Œ Prettier æ ¼å¼åŒ–

### æµ‹è¯•

**åç«¯æµ‹è¯•:**

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
go test ./...

# è¿è¡Œç‰¹å®šåŒ…çš„æµ‹è¯•
go test ./internal/services

# å¸¦è¦†ç›–ç‡
go test -cover ./...
```

**å‰ç«¯æµ‹è¯•:**

```bash
cd web

# ç±»å‹æ£€æŸ¥
npx tsc --noEmit

# (å¯é€‰) æ·»åŠ å•å…ƒæµ‹è¯•æ¡†æ¶å¦‚ Vitest
npm run test
```

### å¸¸è§é—®é¢˜

#### 1. æ•°æ®åº“è¿æ¥å¤±è´¥

**é—®é¢˜:** å¯åŠ¨æ—¶æç¤ºæ•°æ®åº“è¿æ¥å¤±è´¥

**è§£å†³:**
```bash
# æ£€æŸ¥æ•°æ®åº“æ˜¯å¦è¿è¡Œ
# PostgreSQL
pg_isready

# MySQL
mysqladmin ping

# æ£€æŸ¥ç¯å¢ƒå˜é‡
cat .env | grep DB_

# æµ‹è¯•è¿æ¥
psql -h localhost -U postgres -d ads_creative_gen_platform
```

#### 2. å‰ç«¯è®¿é—® 404

**é—®é¢˜:** è®¿é—®å‰ç«¯é¡µé¢è¿”å› 404

**è§£å†³:**
```bash
# ç¡®ä¿å‰ç«¯å·²æ„å»º
cd web && npm run build

# æ£€æŸ¥ dist ç›®å½•
ls -la web/dist/

# é‡å¯åç«¯
go run main.go
```

#### 3. é€šä¹‰ API è°ƒç”¨å¤±è´¥

**é—®é¢˜:** ç”Ÿæˆåˆ›æ„æ—¶æŠ¥é”™ "API Key invalid"

**è§£å†³:**
```bash
# æ£€æŸ¥ API Key
echo $TONGYI_API_KEY

# éªŒè¯ API Key æ˜¯å¦æœ‰æ•ˆ
curl -X POST 'https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation' \
  -H "Authorization: Bearer $TONGYI_API_KEY" \
  -H 'Content-Type: application/json' \
  -d '{
    "model": "qwen-turbo",
    "input": {"prompt": "ä½ å¥½"},
    "parameters": {}
  }'
```

#### 4. ä¸ƒç‰›äº‘ä¸Šä¼ å¤±è´¥

**é—®é¢˜:** å›¾ç‰‡ç”Ÿæˆåä¸Šä¼ ä¸ƒç‰›äº‘å¤±è´¥

**è§£å†³:**
```bash
# æ£€æŸ¥ä¸ƒç‰›äº‘é…ç½®
cat .env | grep QINIU_

# ç¡®ä¿ Bucket å­˜åœ¨ä¸”æœ‰æƒé™
# æ£€æŸ¥å­˜å‚¨åŒºåŸŸé…ç½®æ˜¯å¦æ­£ç¡® (cn-south-1, cn-east-2 ç­‰)
# æ£€æŸ¥ AccessKey/SecretKey æ˜¯å¦æ­£ç¡®
```

#### 5. CORS è·¨åŸŸé”™è¯¯

**é—®é¢˜:** å‰ç«¯å¼€å‘æ¨¡å¼ä¸‹ API è°ƒç”¨æŠ¥ CORS é”™è¯¯

**è§£å†³:**

åç«¯å·²é…ç½® CORS ä¸­é—´ä»¶ (`internal/middleware/cors.go`),ä½†å¦‚æœä»æœ‰é—®é¢˜:

```go
// internal/middleware/cors.go
func CORSMiddleware() gin.HandlerFunc {
    return func(c *gin.Context) {
        c.Writer.Header().Set("Access-Control-Allow-Origin", "*")
        c.Writer.Header().Set("Access-Control-Allow-Methods", "GET, POST, PUT, DELETE, OPTIONS")
        c.Writer.Header().Set("Access-Control-Allow-Headers", "Content-Type, Authorization")

        if c.Request.Method == "OPTIONS" {
            c.AbortWithStatus(204)
            return
        }

        c.Next()
    }
}
```

## æ€§èƒ½ä¼˜åŒ–

### åç«¯ä¼˜åŒ–

- **æ•°æ®åº“ç´¢å¼•**: å·²ä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µæ·»åŠ ç´¢å¼•
- **è¿æ¥æ± **: GORM è‡ªåŠ¨ç®¡ç†æ•°æ®åº“è¿æ¥æ± 
- **å¹¶å‘æ§åˆ¶**: ä½¿ç”¨ Goroutine å¤„ç†å¤šå˜ä½“ç”Ÿæˆ

### å‰ç«¯ä¼˜åŒ–

- **ä»£ç åˆ†å‰²**: Vite è‡ªåŠ¨è¿›è¡Œä»£ç åˆ†å‰²
- **æ‡’åŠ è½½**: å¯ä¸ºå¤§ç»„ä»¶æ·»åŠ  `React.lazy()`
- **å›¾ç‰‡ä¼˜åŒ–**: ä½¿ç”¨ä¸ƒç‰›äº‘ CDN + ç¼©ç•¥å›¾

## å®‰å…¨æ€§

### å½“å‰å®‰å…¨æªæ–½

- **CORS é…ç½®**: é˜²æ­¢æœªæˆæƒçš„è·¨åŸŸè®¿é—®
- **è¾“å…¥éªŒè¯**: ä½¿ç”¨ GORM å‚æ•°åŒ–æŸ¥è¯¢é˜²æ­¢ SQL æ³¨å…¥
- **é root ç”¨æˆ·**: Docker å®¹å™¨ä½¿ç”¨éç‰¹æƒç”¨æˆ·è¿è¡Œ
- **ç¯å¢ƒå˜é‡**: æ•æ„Ÿä¿¡æ¯é€šè¿‡ç¯å¢ƒå˜é‡ç®¡ç†

### å¾…å®ç°

- [ ] ç”¨æˆ·è®¤è¯ (JWT)
- [ ] API é™æµ
- [ ] HTTPS å¼ºåˆ¶
- [ ] è¯·æ±‚ç­¾åéªŒè¯

## è·¯çº¿å›¾

### å·²å®Œæˆ

- [x] åŸºç¡€åˆ›æ„ç”ŸæˆåŠŸèƒ½
- [x] æ–‡æ¡ˆç”Ÿæˆå·¥ä½œæµ
- [x] A/B å®éªŒå¹³å°
- [x] æ¨¡å‹è°ƒç”¨è¿½è¸ª
- [x] å›½é™…åŒ–æ”¯æŒ (ä¸­è‹±æ–‡)
- [x] æ’ä»¶ç³»ç»Ÿ

### è¿›è¡Œä¸­

- [ ] ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- [ ] ç´ æè¯„åˆ†ç³»ç»Ÿå®Œå–„
- [ ] æ‰¹é‡å¯¼å‡ºåŠŸèƒ½

### è®¡åˆ’ä¸­

- [ ] æ›´å¤š AI æ¨¡å‹æ”¯æŒ
- [ ] å®éªŒæŠ¥å‘Šè‡ªåŠ¨ç”Ÿæˆ
- [ ] Webhook é€šçŸ¥
- [ ] API æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆ
